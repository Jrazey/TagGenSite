Sub FindInFile()
 
    Dim sFile As String
    Dim sLine As String
    Dim dCount As Double
    Dim sSearch As String
    
    Dim rSearch As Range
    Dim rResult As Range
    
    Dim iProgress As Integer
    Dim iTotal As Integer
    
    Dim sLine_UCase As String
    Dim sSearch_UCase As String
    
    sFile = Range("Config_L5K_File").Value
    
    iTotal = Selection.Cells.Count
    For Each c In Selection.Cells
    
        sSearch = "*" & c.Value & "*"
        dCount = 0
        iProgress = iProgress + 1
        
        Application.StatusBar = CStr(iProgress) & " / " & CStr(iTotal) & " - " & c.Value
    
        Open sFile For Input As #1
        Do While Not EOF(1)
            Line Input #1, sLine
            ' Changed to make non case sensive
            sLine_UCase = UCase(sLine)
            sSearch_UCase = UCase(sSearch)
            
            If sLine_UCase Like sSearch_UCase Then
               dCount = dCount + 1
            End If
        Loop
        Close #1
        
        c.Offset(0, 1).Value = dCount
    Next
    Application.StatusBar = "Done"
    
End Sub


